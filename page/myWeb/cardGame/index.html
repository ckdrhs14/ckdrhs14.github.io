<!DOCTYPE html>
<html lang="kr">
    <head>
		<meta charset="UTF-8">
		<meta name="Generator" content="EditPlus®">
		<meta name="Author" content="">
		<meta name="Keywords" content="">
		<meta name="Description" content="">
		<link rel="preconnect" href="https://fonts.gstatic.com">
		<link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@900&display=swap" rel="stylesheet">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
		<style type="text/css">
		@font-face {
			 font-family: "S-CoreDream-3Light";
			 src: url("https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_six@1.2/S-CoreDream-3Light.woff") format("woff");
			 font-weight: normal;
			 font-style: normal;
		}
		body {font-family:"S-CoreDream-3Light";}
		table {table-layout:fixed; border-collapse:collapse; display:table-cell; border-spacing:0;}
		.width500px{width: 468px; display: inline-block;}
		.center{text-align: center; display:flex; justify-content:center; align-items:center; width:100%; height:100%; margin-top:-100px;}
		#startBtn{border: none; color: white; background-color: #5AAFFF; width: 75px;padding: 5px; font-weight: bold; cursor: pointer; margin-bottom:10px; margin-right:10px;}
		#cardTable{border-collapse: collapse;}
		#cardTable td{border: 1px solid #5AAFFF; width: 75px; max-width:75px; height: 120px; text-align: center; cursor: pointer;}
		#cardTable td img{max-width: 70px;}
		#cardTable td span{font-size: 25pt; font-weight: bold; color: #5AAFFF; display: none;}
		#countDown{background-color: #5AAFFF; color: white; font-size: 20pt;}
		#info{width: 468px; height: 250px; background-color: #DDDDDD; color: white; padding-top: 230px;}
		</style>
	</head>
	<script>
		// 게임 상태
		var gameState = "";

		// 열린 카드 src
		var openCardId = "";
		var openCardId2 = "";

		// 난수 생성 함수
		function generateRandom (min, max) {
			var ranNum = Math.floor(Math.random()*(max-min+1)) + min;
				return ranNum;
		}

		
		var cards; // 카드 목록
		var score = 0; // 점수
		var openedCtn = 0; // 맞춘 카드 갯수
		
		// 카드 배치
		function setTable(){
			cards = [
			"1.jpg","1.jpg", // 피카츄
			"2.jpg","2.jpg", // 파이리
			"3.jpg","3.jpg", // 꼬부기
			"4.jpg","4.jpg", // 이상해씨
			"5.jpg","5.jpg", // 어니부기
			"6.jpg","6.jpg", // 버터풀
			"7.jpg","7.jpg", // 푸린
			"8.jpg","8.jpg", // 식스테일
			"9.jpg","9.jpg", // 리자몽
			"10.jpg","10.jpg", // 거북왕
			"11.jpg","11.jpg", // 모래두지
			"12.jpg","12.jpg" // 삐삐
			];
			var cardTableCode = "<tr>";                
			for(var i=0;i<24;i++) {
				if(i>0 && i%6 == 0){
					cardTableCode += "</tr><tr>";
				}
				var idx = generateRandom(0,23-i);
				var img = cards.splice(idx,1);

				cardTableCode += '<td id="card"+i+""><img src="images/"+img+""><span>?</span></td>';
			}
			cardTableCode += "</tr>";
			$("#cardTable").html(cardTableCode);
		}

		// 카드 전체 가리기
		function hiddenCards(){
			$("#cardTable td img").hide();
			$("#cardTable td span").show();
		}

		// 게임 시작
		function startGame() {
			var sec = 6;
			
			$("#info").hide(); // 안내 문구 가리기
			scoreInit(); // 점수 초기화
			setTable(); // 카드 배치
			
			//카운트 다운
			function setText(){
				$("#countDown").text(--sec);
			}

			//카운트 다운
			var intervalID = setInterval(setText, 1000);
			setTimeout(function(){
				clearInterval(intervalID);
				$("#countDown").text("start");
				hiddenCards();
				gameState = "";
			}, 6000);
		}


		// 카드 선택 시
		$(document).on("click", "#cardTable td", function(){
			if(gameState != "") return; // 게임 카운트 다운중일 때 누른 경우 return
			if(openCardId2 != "") return; // 2개 열려있는데 또 누른 경우 return
			if($(this).hasClass("opened")) return; // 열려있는 카드를 또 누른 경우                
			$(this).addClass("opened"); // 열여있다는 것을 구분하기 위한 class 추가

			if(openCardId == "") {
				$(this).find("img").show();
				$(this).find("span").hide();
				openCardId = this.id;
			}else {
				if(openCardId == openCardId2) return; //같은 카드 누른 경우 return

				$(this).find("img").show();
				$(this).find("span").hide();
				
				var openCardSrc = $("#"+openCardId).find("img").attr("src");
				var openCardSrc2 = $(this).find("img").attr("src");
				openCardId2 = this.id;
				
				if(openCardSrc == openCardSrc2) { // 일치
					openCardId = "";
					openCardId2 = "";
					scorePlus();
					if(++openedCtn == 12){
						alert("성공!!\n"+score+"점 입니다!");
					}
				}else { // 불일치
					setTimeout(back, 1000);
					scoreMinus();
				}
			}
		});

		// 두개의 카드 다시 뒤집기
		function back() {
			$("#"+openCardId).find("img").hide();
			$("#"+openCardId).find("span").show();
			$("#"+openCardId2).find("img").hide();
			$("#"+openCardId2).find("span").show();
			$("#"+openCardId).removeClass("opened");
			$("#"+openCardId2).removeClass("opened");
			openCardId = "";
			openCardId2 = "";
		}

		// 점수 초기화
		function scoreInit(){
			score = 0;
			openedCtn = 0;
			$("#score").text(score);
		}
		// 점수 증가
		function scorePlus(){
			score += 10;
			$("#score").text(score);
		}
		// 점수 감소
		function scoreMinus(){
			score -= 5;
			$("#score").text(score);
		}

		$(document).on("click", "#startBtn", function(){
			if(gameState == "") {
				startGame();
				gameState = "alreadyStart"
			}
		});


	</script>

    <body class="center">
        <div class="width500px">
            <div>
                <h2>같은 그림 찾기</h2>
                <table id="menuTable">
                    <tr>
                        <td class="alignLeft">
                            <button id="startBtn">start</button>
                        </td>
                        <td class="alignRight">
                            <span>score : <span id="score">0</span></span>
                        </td>
                    </tr>
                </table>
            </div>
            <div>
                <div id="countDown">
                    ready
                </div>
                <table id="cardTable">
                </table>
                <div id="info">
                    start 버튼을 눌러주세요<br>
                </div>
            </div>
        </div>
    </body>
</html>
